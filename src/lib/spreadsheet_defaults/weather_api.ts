import type { SpreadsheetSerialized } from "../spreadsheet";

export const weatherApi: SpreadsheetSerialized = {
  "key": "weatherApi", "grid": [null, [null, { "type": "normal", "location": { "row": 1, "col": 1 }, "value": "Latitude", "format": null, "calculate": null, "style": { "bold": true, "italic": false, "underline": true } }, { "type": "normal", "location": { "row": 1, "col": 2 }, "value": "Longitude", "format": null, "calculate": null, "style": { "bold": true, "italic": false, "underline": true } }, { "type": "normal", "location": { "row": 1, "col": 3 }, "value": "", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }, { "type": "normal", "location": { "row": 1, "col": 4 }, "value": "Credit to https://open-meteo.com for weather data", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }], [null, { "type": "normal", "location": { "row": 2, "col": 1 }, "value": 10.52, "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }, { "type": "normal", "location": { "row": 2, "col": 2 }, "value": -61.28, "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }, null, { "type": "normal", "location": { "row": 2, "col": 4 }, "value": "", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }], [null, { "type": "normal", "location": { "row": 3, "col": 1 }, "value": "", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }, null, null, null, { "type": "normal", "location": { "row": 3, "col": 5 }, "value": "", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }], [null, { "type": "button", "location": { "row": 4, "col": 1 }, "label": "Click to update", "buttonStyle": "primary", "action": "const lat = get(\"B2\")\nconst lng = get(\"C2\")\n\nconst url = \"https://api.open-meteo.com/v1/forecast\";\nconst latParam = `latitude=${lat}`;\nconst lngParam = `&longitude=${lng}`;\n\nconst res = await fetch(`${url}?${latParam}${lngParam}&hourly=temperature_2m&forecast_days=1`);\n\nconst degSymbol = \"°C\";\n\nconst formatDate = (dateStr) => {\n  const date = new Date(dateStr);\n  let hours = date.getHours();\n  let minutes = date.getMinutes();\n  const ampm = hours >= 12 ? 'pm' : 'am';\n  hours = hours % 12;\n  hours = hours ? hours : 12;\n  minutes = \n    minutes < 10 ? '0' + minutes : minutes;\n  return hours + ':' + minutes + ' ' + ampm;\n};\n\nconst json = await res.json();\njson.hourly.time.forEach((dateStr, i) => {\n  const temp = \n    json.hourly.temperature_2m[i];\n\n  const row = 7 + i;\n  set(`B${row}`, formatDate(dateStr));\n  set(`C${row}`, `${temp}${degSymbol}`);\n});\n\n\n\n" }, { "type": "normal", "location": { "row": 4, "col": 2 }, "value": "", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }], [null, { "type": "normal", "location": { "row": 5, "col": 1 }, "value": "", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }, null, null, null, { "type": "normal", "location": { "row": 5, "col": 5 }, "value": "", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }, { "type": "normal", "location": { "row": 5, "col": 6 }, "value": "", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }], [null, { "type": "normal", "location": { "row": 6, "col": 1 }, "value": "Hour", "format": null, "calculate": null, "style": { "bold": true, "italic": false, "underline": true } }, { "type": "normal", "location": { "row": 6, "col": 2 }, "value": "Temperature", "format": null, "calculate": null, "style": { "bold": true, "italic": false, "underline": true } }], [null, { "type": "normal", "location": { "row": 7, "col": 1 }, "value": "12:00 am", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }, { "type": "normal", "location": { "col": 2, "row": 7 }, "value": "27.4°C", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }, { "type": "normal", "location": { "row": 7, "col": 3 }, "value": "", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }, null, { "type": "normal", "location": { "row": 7, "col": 5 }, "value": "", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }], [null, { "type": "normal", "location": { "col": 1, "row": 8 }, "value": "1:00 am", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }, { "type": "normal", "location": { "col": 2, "row": 8 }, "value": "27°C", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }, null, { "type": "normal", "location": { "row": 8, "col": 4 }, "value": "", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }], [null, { "type": "normal", "location": { "col": 1, "row": 9 }, "value": "2:00 am", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }, { "type": "normal", "location": { "col": 2, "row": 9 }, "value": "26.6°C", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }], [null, { "type": "normal", "location": { "col": 1, "row": 10 }, "value": "3:00 am", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }, { "type": "normal", "location": { "col": 2, "row": 10 }, "value": "26.3°C", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }], [null, { "type": "normal", "location": { "col": 1, "row": 11 }, "value": "4:00 am", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }, { "type": "normal", "location": { "col": 2, "row": 11 }, "value": "26.1°C", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }], [null, { "type": "normal", "location": { "col": 1, "row": 12 }, "value": "5:00 am", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }, { "type": "normal", "location": { "col": 2, "row": 12 }, "value": "25.9°C", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }], [null, { "type": "normal", "location": { "col": 1, "row": 13 }, "value": "6:00 am", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }, { "type": "normal", "location": { "col": 2, "row": 13 }, "value": "25.9°C", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }], [null, { "type": "normal", "location": { "col": 1, "row": 14 }, "value": "7:00 am", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }, { "type": "normal", "location": { "col": 2, "row": 14 }, "value": "25.7°C", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }], [null, { "type": "normal", "location": { "col": 1, "row": 15 }, "value": "8:00 am", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }, { "type": "normal", "location": { "col": 2, "row": 15 }, "value": "25.6°C", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }], [null, { "type": "normal", "location": { "col": 1, "row": 16 }, "value": "9:00 am", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }, { "type": "normal", "location": { "col": 2, "row": 16 }, "value": "25.6°C", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }], [null, { "type": "normal", "location": { "col": 1, "row": 17 }, "value": "10:00 am", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }, { "type": "normal", "location": { "col": 2, "row": 17 }, "value": "25.6°C", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }], [null, { "type": "normal", "location": { "col": 1, "row": 18 }, "value": "11:00 am", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }, { "type": "normal", "location": { "col": 2, "row": 18 }, "value": "26.4°C", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }], [null, { "type": "normal", "location": { "col": 1, "row": 19 }, "value": "12:00 pm", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }, { "type": "normal", "location": { "col": 2, "row": 19 }, "value": "28°C", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }], [null, { "type": "normal", "location": { "col": 1, "row": 20 }, "value": "1:00 pm", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }, { "type": "normal", "location": { "col": 2, "row": 20 }, "value": "28.8°C", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }], [null, { "type": "normal", "location": { "col": 1, "row": 21 }, "value": "2:00 pm", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }, { "type": "normal", "location": { "col": 2, "row": 21 }, "value": "29.5°C", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }], [null, { "type": "normal", "location": { "col": 1, "row": 22 }, "value": "3:00 pm", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }, { "type": "normal", "location": { "col": 2, "row": 22 }, "value": "30.2°C", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }], [null, { "type": "normal", "location": { "col": 1, "row": 23 }, "value": "4:00 pm", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }, { "type": "normal", "location": { "col": 2, "row": 23 }, "value": "30.1°C", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }], [null, { "type": "normal", "location": { "col": 1, "row": 24 }, "value": "5:00 pm", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }, { "type": "normal", "location": { "col": 2, "row": 24 }, "value": "30.3°C", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }], [null, { "type": "normal", "location": { "col": 1, "row": 25 }, "value": "6:00 pm", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }, { "type": "normal", "location": { "col": 2, "row": 25 }, "value": "29.9°C", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }], [null, { "type": "normal", "location": { "col": 1, "row": 26 }, "value": "7:00 pm", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }, { "type": "normal", "location": { "col": 2, "row": 26 }, "value": "29.1°C", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }], [null, { "type": "normal", "location": { "col": 1, "row": 27 }, "value": "8:00 pm", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }, { "type": "normal", "location": { "col": 2, "row": 27 }, "value": "29°C", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }], [null, { "type": "normal", "location": { "col": 1, "row": 28 }, "value": "9:00 pm", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }, { "type": "normal", "location": { "col": 2, "row": 28 }, "value": "28.6°C", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }], [null, { "type": "normal", "location": { "col": 1, "row": 29 }, "value": "10:00 pm", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }, { "type": "normal", "location": { "col": 2, "row": 29 }, "value": "27.8°C", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }], [null, { "type": "normal", "location": { "col": 1, "row": 30 }, "value": "11:00 pm", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }, { "type": "normal", "location": { "col": 2, "row": 30 }, "value": "26.9°C", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }]], "customColSizes": [null, 147, 148, null, 298]
};
