import type { SpreadsheetSerialized } from "../spreadsheet";

export const compoundInterest: SpreadsheetSerialized = { "key": "compoundInterest", "grid": [[null, { "type": "normal", "location": { "row": 0, "col": 1 }, "value": "Compound Interest Calculator", "format": null, "calculate": null, "style": { "bold": true, "italic": false, "underline": true } }], [null, { "type": "normal", "location": { "row": 1, "col": 1 }, "value": "Initial Investment", "format": null, "calculate": "// validate C1\nconst c1 = get(\"C1\")\nif (typeof c1 !== \"number\") {\n  set(\"C1\", 0);\n}\nelse if (c1 < 0) {\n  set(\"C1\", 0);\n}\nelse if (c1 > 10000000) {\n  set(\"C1\", 10000000);\n}\n\nreturn \"Initial Investment\";", "style": { "bold": true, "italic": false, "underline": false } }, { "type": "normal", "location": { "row": 1, "col": 2 }, "value": 5000, "format": "return `$${value}`;", "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }, null, { "type": "normal", "location": { "row": 1, "col": 4 }, "value": "[FUNCTION IS HERE]", "format": null, "calculate": "// clear old\nset(\"B8:D49\", \"\");\n\nlet total = get(\"C1\");\nlet interest = 0;\nconst contribution = get(\"C2\");\nconst years = get(\"C3\");\nconst rate = get(\"C4\");\nconst compoundEvery = get(\"C5\");\n\nconst monthRate = rate / 12;\nlet monthsSinceCompound = 0;\n\n// year 0\nset(\"B8\", \"Year 0\");\nset(\"C8\", `$${total}`);\nset(\"D8\", `$0`);\n\nfor (let i = 0; i < years; i++) {\n  const row = 9 + i;\n\n  // set label for year\n  set(`B${row}`, `Year ${i + 1}`);\n\n  for (let m = 0; m < 12; m++) {\n    // add contribution\n    // skip first month of first year\n    if (!(i === 0 && m === 0)) {\n      total += contribution;\n    }\n\n    // should we compound\n    monthsSinceCompound++;\n    if (monthsSinceCompound >= compoundEvery) {\n      const calcInterest = ((monthRate * compoundEvery) / 100) * total;\n      interest += calcInterest;\n      total += calcInterest;\n      monthsSinceCompound = 0;\n    }\n  }\n\n  set(`C${row}`, `$${Math.floor(total + contribution)}`);\n  set(`D${row}`, `$${Math.floor(interest)}`);\n}\n\nreturn \"[FUNCTION IS HERE]\";\n", "style": { "bold": false, "italic": false, "underline": false } }], [null, { "type": "normal", "location": { "row": 2, "col": 1 }, "value": "Monthly Contribution", "format": null, "calculate": "// validate C2\nconst v = get(\"C2\")\nif (typeof v !== \"number\") {\n  set(\"C2\", 0);\n}\nelse if (v < 0) {\n  set(\"C2\", 0);\n}\nelse if (v > 10000000) {\n  set(\"C2\", 10000000);\n}\n\nreturn \"Monthly Contribution\";", "style": { "bold": true, "italic": false, "underline": false } }, { "type": "normal", "location": { "row": 2, "col": 2 }, "value": 1000, "format": "return `$${value}`;", "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }], [null, { "type": "normal", "location": { "row": 3, "col": 1 }, "value": "Length of Time (Years)", "format": null, "calculate": "// validate C3\nconst v = get(\"C3\")\nif (typeof v !== \"number\") {\n  set(\"C3\", 0);\n}\nelse if (v < 0) {\n  set(\"C3\", 0);\n}\nelse if (v > 40) {\n  set(\"C3\", 40);\n}\n\nreturn \"Length of Time (Years)\";", "style": { "bold": true, "italic": false, "underline": false } }, { "type": "normal", "location": { "row": 3, "col": 2 }, "value": 20, "format": "return `${value} years`;", "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }], [null, { "type": "normal", "location": { "row": 4, "col": 1 }, "value": "Interest Rate", "format": null, "calculate": "// validate C4\nconst v = get(\"C4\")\nif (typeof v !== \"number\") {\n  set(\"C4\", 0);\n}\nelse if (v < 0) {\n  set(\"C4\", 0);\n}\nelse if (v > 100) {\n  set(\"C4\", 100);\n}\n\nreturn \"Interest Rate\";", "style": { "bold": true, "italic": false, "underline": false } }, { "type": "normal", "location": { "row": 4, "col": 2 }, "value": 6, "format": "return `${value}%`;", "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }], [null, { "type": "normal", "location": { "row": 5, "col": 1 }, "value": "Compound Every", "format": null, "calculate": "const v = get(\"C5\")\nif (typeof v !== \"number\") {\n  set(\"C5\", 0);\n}\nelse if (v < 0) {\n  set(\"C5\", 0);\n}\nelse if (v > 100) {\n  set(\"C5\", 100);\n}\n\nreturn \"Compound Every\";", "style": { "bold": true, "italic": false, "underline": false } }, { "type": "normal", "location": { "row": 5, "col": 2 }, "value": 1, "format": "return `${value} month${value === 1 ? \"\" : \"s\"}`;", "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }], null, [null, { "type": "normal", "location": { "row": 7, "col": 1 }, "value": "Year", "format": null, "calculate": null, "style": { "bold": true, "italic": false, "underline": true } }, { "type": "normal", "location": { "row": 7, "col": 2 }, "value": "Investment Value", "format": null, "calculate": null, "style": { "bold": true, "italic": false, "underline": true } }, { "type": "normal", "location": { "row": 7, "col": 3 }, "value": "Accrued Interest", "format": null, "calculate": null, "style": { "bold": true, "italic": false, "underline": true } }], [null, { "type": "normal", "location": { "row": 8, "col": 1 }, "value": "Year 0", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }, { "type": "normal", "location": { "row": 8, "col": 2 }, "value": "$5000", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }, { "type": "normal", "location": { "row": 8, "col": 3 }, "value": "$0", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }], [null, { "type": "normal", "location": { "row": 9, "col": 1 }, "value": "Year 1", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }, { "type": "normal", "location": { "row": 9, "col": 2 }, "value": "$17643", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }, { "type": "normal", "location": { "row": 9, "col": 3 }, "value": "$643", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }], [null, { "type": "normal", "location": { "row": 10, "col": 1 }, "value": "Year 2", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }, { "type": "normal", "location": { "row": 10, "col": 2 }, "value": "$31067", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }, { "type": "normal", "location": { "col": 3, "row": 10 }, "value": "$2067", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }], [null, { "type": "normal", "location": { "row": 11, "col": 1 }, "value": "Year 3", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }, { "type": "normal", "location": { "col": 2, "row": 11 }, "value": "$45319", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }, { "type": "normal", "location": { "row": 11, "col": 3 }, "value": "$4319", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }], [null, { "type": "normal", "location": { "row": 12, "col": 1 }, "value": "Year 4", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }, { "type": "normal", "location": { "col": 2, "row": 12 }, "value": "$60450", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }, { "type": "normal", "location": { "col": 3, "row": 12 }, "value": "$7450", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }], [null, { "type": "normal", "location": { "col": 1, "row": 13 }, "value": "Year 5", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }, { "type": "normal", "location": { "col": 2, "row": 13 }, "value": "$76514", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }, { "type": "normal", "location": { "col": 3, "row": 13 }, "value": "$11514", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }], [null, { "type": "normal", "location": { "col": 1, "row": 14 }, "value": "Year 6", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }, { "type": "normal", "location": { "col": 2, "row": 14 }, "value": "$93569", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }, { "type": "normal", "location": { "col": 3, "row": 14 }, "value": "$16569", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }], [null, { "type": "normal", "location": { "col": 1, "row": 15 }, "value": "Year 7", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }, { "type": "normal", "location": { "col": 2, "row": 15 }, "value": "$111675", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }, { "type": "normal", "location": { "col": 3, "row": 15 }, "value": "$22675", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }], [null, { "type": "normal", "location": { "col": 1, "row": 16 }, "value": "Year 8", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }, { "type": "normal", "location": { "col": 2, "row": 16 }, "value": "$130899", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }, { "type": "normal", "location": { "col": 3, "row": 16 }, "value": "$29899", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }], [null, { "type": "normal", "location": { "col": 1, "row": 17 }, "value": "Year 9", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }, { "type": "normal", "location": { "col": 2, "row": 17 }, "value": "$151308", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }, { "type": "normal", "location": { "col": 3, "row": 17 }, "value": "$38308", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }], [null, { "type": "normal", "location": { "col": 1, "row": 18 }, "value": "Year 10", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }, { "type": "normal", "location": { "col": 2, "row": 18 }, "value": "$172976", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }, { "type": "normal", "location": { "col": 3, "row": 18 }, "value": "$47976", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }], [null, { "type": "normal", "location": { "col": 1, "row": 19 }, "value": "Year 11", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }, { "type": "normal", "location": { "col": 2, "row": 19 }, "value": "$195980", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }, { "type": "normal", "location": { "col": 3, "row": 19 }, "value": "$58980", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }], [null, { "type": "normal", "location": { "col": 1, "row": 20 }, "value": "Year 12", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }, { "type": "normal", "location": { "col": 2, "row": 20 }, "value": "$220403", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }, { "type": "normal", "location": { "col": 3, "row": 20 }, "value": "$71403", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }], [null, { "type": "normal", "location": { "col": 1, "row": 21 }, "value": "Year 13", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }, { "type": "normal", "location": { "col": 2, "row": 21 }, "value": "$246333", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }, { "type": "normal", "location": { "col": 3, "row": 21 }, "value": "$85333", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }], [null, { "type": "normal", "location": { "col": 1, "row": 22 }, "value": "Year 14", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }, { "type": "normal", "location": { "col": 2, "row": 22 }, "value": "$273862", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }, { "type": "normal", "location": { "col": 3, "row": 22 }, "value": "$100862", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }], [null, { "type": "normal", "location": { "col": 1, "row": 23 }, "value": "Year 15", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }, { "type": "normal", "location": { "col": 2, "row": 23 }, "value": "$303089", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }, { "type": "normal", "location": { "col": 3, "row": 23 }, "value": "$118089", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }], [null, { "type": "normal", "location": { "col": 1, "row": 24 }, "value": "Year 16", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }, { "type": "normal", "location": { "col": 2, "row": 24 }, "value": "$334118", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }, { "type": "normal", "location": { "col": 3, "row": 24 }, "value": "$137118", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }], [null, { "type": "normal", "location": { "col": 1, "row": 25 }, "value": "Year 17", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }, { "type": "normal", "location": { "col": 2, "row": 25 }, "value": "$367061", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }, { "type": "normal", "location": { "col": 3, "row": 25 }, "value": "$158061", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }], [null, { "type": "normal", "location": { "col": 1, "row": 26 }, "value": "Year 18", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }, { "type": "normal", "location": { "col": 2, "row": 26 }, "value": "$402037", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }, { "type": "normal", "location": { "col": 3, "row": 26 }, "value": "$181037", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }], [null, { "type": "normal", "location": { "col": 1, "row": 27 }, "value": "Year 19", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }, { "type": "normal", "location": { "col": 2, "row": 27 }, "value": "$439169", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }, { "type": "normal", "location": { "col": 3, "row": 27 }, "value": "$206169", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }], [null, { "type": "normal", "location": { "col": 1, "row": 28 }, "value": "Year 20", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }, { "type": "normal", "location": { "col": 2, "row": 28 }, "value": "$478591", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }, { "type": "normal", "location": { "col": 3, "row": 28 }, "value": "$233591", "format": null, "calculate": null, "style": { "bold": false, "italic": false, "underline": false } }],], "customColSizes": [141, 215, 157, 152] };
